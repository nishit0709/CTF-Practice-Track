from base64 import b64decode, b64encode
import requests

original_cookie = b64decode('WXJqcVJMT2QyV2JBQ0hxRTlsQXJvaDJWVlJ4djkyYmowaHNPRlMvcE5OSTBXVkJvREpycFQ0SXl6U21UZkxJNXp0V29tblJxSzdNb3FDNS9jV1pvb1FJRGNlTGI1d2tOYVNUc0c4VFI3bDZPd256VnFKUll1VzhER3JyUElTRHI=')
original_cookie = bytearray(original_cookie)

def bitFlip(cookie_char_pos, bit_pos):
    altered_cookie = original_cookie
    flipped = altered_cookie[cookie_char_pos] ^ bit_pos
    altered_cookie[cookie_char_pos] = flipped
    altered_cookie_b64 = b64encode(bytes(altered_cookie))
    return altered_cookie_b64.decode('utf-8')


for cookie_char_pos in range(len(original_cookie)):
    print(f"Checking cookie pos: {cookie_char_pos}")
    for bit_pos in range(128):
        altered_cookie = bitFlip(cookie_char_pos, bit_pos)
        cookies = {'auth_name': altered_cookie}
        r = requests.get('http://mercury.picoctf.net:56136/', cookies = cookies)
        t = r.text.lower()
        if  'picoCTF {' in t or 'picoCTF{' in t:
            print(t)
            break


